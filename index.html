 <!DOCTYPE html>
 <html lang="es">
 <head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Verificar Envío de Datos Firebase</title>
 </head>
 <body>
   <h1>Enviar Datos a Firebase</h1>
   <form id="dataForm">
     <label for="texto">Texto a enviar:</label><br>
     <input type="text" id="texto" name="texto"><br><br>
     <button type="button" id="enviarDatos">Enviar Datos</button>
   </form>

   <h2>Datos Enviados (Consola):</h2>
   <pre id="output"></pre>

   <script type="module">
     import { initializeApp } from 'firebase/app-compat';
     import { getDatabase, ref, push, set } from 'firebase/database-compat';

     const firebaseConfig = {
       apiKey: "AIzaSyAg5z1F4Dx6z9x0VHrBc45gnzgBm0Sa65s",
       authDomain: "tc-1-81110.firebaseapp.com",
       projectId: "tc-1-81110",
       storageBucket: "tc-1-81110.firebasestorage.app",
       messagingSenderId: "1020958300613",
       appId: "1:1020958300613:web:0f95e201916b1c5ea153ac",
       measurementId: "G-8V0GYS69ZL"
     };

     let app;
     try {
       app = initializeApp(firebaseConfig);
       console.log('Firebase App inicializada:', app);
     } catch (error) {
       alert('Error al inicializar Firebase: ' + error);
       console.error('Error al inicializar Firebase:', error);
     }

     let database;
     if (app) {
       database = getDatabase(app);
       console.log('Firebase Database inicializada:', database);
     }

     document.addEventListener('DOMContentLoaded', function() {
       console.log('DOMContentLoaded ejecutado');
       const enviarBoton = document.getElementById('enviarDatos');
       console.log('Botón enviar encontrado:', enviarBoton);
       const textoInput = document.getElementById('texto');
       const outputDiv = document.getElementById('output');
       const dataForm = document.getElementById('dataForm');

       if (enviarBoton) {
         enviarBoton.addEventListener('click', async function() {
           console.log('Función enviarDatos() llamada al hacer clic');
           if (!database) {
             alert('Realtime Database no se ha inicializado.');
             console.error('Realtime Database no inicializada.');
             return;
           }

           const textoValor = textoInput.value;
           console.log('Texto ingresado:', textoValor);
           if (textoValor) {
             const mensajesRef = ref(database, 'mensajes');
             const nuevoMensajeRef = push(mensajesRef);

             try {
               console.log('Intentando enviar datos...');
               await set(nuevoMensajeRef, { texto: textoValor, timestamp: new Date().toISOString() });
               const mensaje = `Datos enviados con ID: ${nuevoMensajeRef.key}, Texto: ${textoValor}`;
               alert(mensaje);
               console.log(mensaje);
               outputDiv.textContent += mensaje + '\n';
               textoInput.value = '';
             } catch (error) {
               const mensajeError = 'Error al enviar datos: ' + error;
               alert(mensajeError);
               console.error(mensajeError);
               outputDiv.textContent += mensajeError + '\n';
             }
           } else {
             alert('Por favor, ingresa algún texto.');
           }
         });
         console.log('Listener agregado al botón enviar');
       } else {
         alert('Error: No se encontró el botón de enviar datos.');
         console.error('Error: No se encontró el botón de enviar datos.');
       }
     });
   </script>
 </body>
 </html>
 
